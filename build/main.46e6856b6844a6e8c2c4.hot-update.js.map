{"version":3,"sources":["webpack:///./module/Calendar/Calendar.js","webpack:///webpack/runtime/getFullHash"],"names":["Calendar","selector","user","root","document","querySelector","addEventBtn","events","filtred","handlers","click","dragNdrop","activeEvents","init","console","log","rights","forEach","right","getMethodName","clickListener","clickHandler","e","target","handler","addEventListener","filter","filterByUser","bind","filterByMember","Select","label","placeholder","defaultSeleted","data","id","value","team","onSelect","item","getEventStore","length","render","newEvent","push","style","display","rmEvent","calendar","dataTransfer","dragTarget","closest","classes","setData","dataset","eventId","targetBooked","classList","add","preventDefault","remove","getData","eventIndex","findIndex","event","time","day","localStorage","eventStore","JSON","stringify","resetGrid","reduce","arr","partisipants","member","elem","targetElem","firstFree","firstFreeSlot","modalId","modal","addEvent","eventSlot","removeEvent","warn","eventName","capitalize"],"mappings":"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","file":"main.46e6856b6844a6e8c2c4.hot-update.js","sourcesContent":["import addEvent from '../addEvent';\r\nimport { classes, team } from '../auxiliary';\r\nimport removeEvent from '../removeEvent';\r\nimport { getEventStore, render, resetGrid } from '../render';\r\nimport Select from '../UI/select/select';\r\nimport { capitalize, firstFreeSlot } from '../utils';\r\n\r\nexport default class Calendar {\r\n  constructor(selector, user) {\r\n    this.root = document.querySelector(selector);\r\n    this.user = user;\r\n    this.addEventBtn = this.root.querySelector('[data-type=\"add-event\"]');\r\n\r\n    this.events = [];\r\n    this.filtred = [];\r\n\r\n    this.handlers = {\r\n      click: [],\r\n      dragNdrop: [],\r\n    };\r\n\r\n    this.activeEvents = {};\r\n\r\n    this.init();\r\n  }\r\n\r\n  init() {\r\n    console.log(this.user);\r\n    this.user.rights.forEach(right => this[getMethodName(right)]());\r\n    this.clickListener();\r\n  }\r\n\r\n  clickListener() {\r\n    const clickHandler = e => {\r\n      const { target } = e;\r\n      this.handlers.click.forEach(handler => this[handler](target));\r\n    };\r\n\r\n    this.root.addEventListener('click', clickHandler);\r\n  }\r\n\r\n  onFilter() {\r\n    const filter = this.filterByUser.bind(this);\r\n    // eslint-disable-next-line no-unused-vars\r\n    const filterByMember = new Select('#filter', {\r\n      label: 'Filter',\r\n      placeholder: 'Choose member...',\r\n      defaultSeleted: '0',\r\n      data: [\r\n        { id: '0', value: 'All members' },\r\n        ...team,\r\n      ],\r\n      onSelect(item) {\r\n        filter(item);\r\n      },\r\n    });\r\n\r\n    this.events = getEventStore();\r\n    if (this.events.length > 0) {\r\n      this.events.forEach(render);\r\n    }\r\n  }\r\n\r\n  onAdd() {\r\n    this.newEvent = this.newEvent.bind(this);\r\n    this.handlers.click.push('newEvent');\r\n    this.addEventBtn.style.display = 'flex';\r\n  }\r\n\r\n  onRemove() {\r\n    this.rmEvent = this.rmEvent.bind(this);\r\n    this.handlers.click.push('rmEvent');\r\n  }\r\n\r\n  onUpdatedd() {\r\n    this.calendar.addEventListener('dragstart', e => {\r\n      const { target, dataTransfer } = e;\r\n      const dragTarget = target.closest(`.${classes.slotBooked}`);\r\n      if (dragTarget) {\r\n        dataTransfer.setData('text/plain', dragTarget.dataset.eventId);\r\n      }\r\n    });\r\n\r\n    this.calendar.addEventListener('dragenter', e => {\r\n      const { target } = e;\r\n      const targetBooked = target.closest(`.${classes.slotBooked}`);\r\n      if (!targetBooked && target.closest(`.${classes.eventSlot}`)) {\r\n        e.target.classList.add('drag-hover');\r\n      }\r\n    });\r\n\r\n    this.calendar.addEventListener('dragover', e => {\r\n      const { target } = e;\r\n      const targetBooked = target.closest(`.${classes.slotBooked}`);\r\n      if (!targetBooked && target.closest(`.${classes.eventSlot}`)) {\r\n        e.preventDefault();\r\n      }\r\n    });\r\n\r\n    this.calendar.addEventListener('dragleave', e => {\r\n      e.target.classList.remove('drag-hover');\r\n    });\r\n\r\n    this.calendar.addEventListener('drop', e => {\r\n      const { target, dataTransfer } = e;\r\n      const targetBooked = target.closest(`.${classes.slotBooked}`);\r\n\r\n      if (!targetBooked && target.closest(`.${classes.eventSlot}`)) {\r\n        e.preventDefault();\r\n        target.classList.remove('drag-hover');\r\n        const eventId = dataTransfer.getData('text/plain');\r\n        dataTransfer.setData('text/plain', '');\r\n\r\n        const eventIndex = this.events.findIndex(event => event.id === eventId);\r\n        this.events[eventIndex].time = target.dataset.time;\r\n        this.events[eventIndex].day = target.dataset.day;\r\n\r\n        localStorage.eventStore = JSON.stringify(this.events);\r\n        resetGrid();\r\n        this.events.forEach(render);\r\n      }\r\n    });\r\n  }\r\n\r\n  filterByUser(item) {\r\n    if (item.id === '0') {\r\n      resetGrid();\r\n      this.events.forEach(render);\r\n      return;\r\n    }\r\n    const filtred = this.events.reduce((arr, event) => {\r\n      event.partisipants.forEach(member => {\r\n        if (member.id === item.id) {\r\n          arr.push(event);\r\n        }\r\n      });\r\n      return arr;\r\n    }, []);\r\n    this.filtred = filtred;\r\n    resetGrid();\r\n    console.log(filtred);\r\n    filtred.forEach(render);\r\n  }\r\n\r\n  newEvent(elem) {\r\n    if (elem.closest(`.${classes.triggerOpen}`)) {\r\n      const targetElem = elem.closest(`.${classes.triggerOpen}`);\r\n      const firstFree = firstFreeSlot(this.calendar);\r\n      const day = targetElem.dataset.day ? targetElem.dataset.day : firstFree.day;\r\n      const time = targetElem.dataset.time ? targetElem.dataset.time : firstFree.time;\r\n      const modalId = targetElem.dataset.modal;\r\n      if (modalId) { addEvent(modalId, this.events, day, time); }\r\n    }\r\n  }\r\n\r\n  rmEvent(elem) {\r\n    if (elem.closest(`.${classes.removeEvent}`)) {\r\n      const eventSlot = elem.closest(`.${classes.slotBooked}`);\r\n      if (eventSlot) {\r\n        removeEvent('event-remove', eventSlot, this.events);\r\n      } else { console.warn('No event'); }\r\n    }\r\n  }\r\n}\r\n\r\nfunction getMethodName(eventName) {\r\n  return `on${capitalize(eventName)}`;\r\n}\r\n","__webpack_require__.h = function() { return \"04b618dbee0942e37782\"; }"],"sourceRoot":""}