{"version":3,"sources":["webpack:///./module/DataLayer/DataLayer.js","webpack:///webpack/runtime/getFullHash"],"names":["conf","usersEntity","eventsEntity","DataLayer","exsists","instance","resStatus","users","events","init","getData","entity","res","status","Error","json","data","getDataFromJSON","console","log","warn","obj","postData","JSON","stringify","id","push","index","eventJson","updateData","list","forEach","item","parse"],"mappings":"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","file":"main.e5acd807df7fe558aa15.hot-update.js","sourcesContent":["import { getData, postData, updateData } from './dataUtils';\r\n\r\nconst conf = {\r\n  usersEntity: 'users',\r\n  eventsEntity: 'events',\r\n};\r\n\r\nexport default class DataLayer {\r\n  constructor() {\r\n    if (DataLayer.exsists) {\r\n      return DataLayer.instance;\r\n    }\r\n    DataLayer.instance = this;\r\n    DataLayer.exsists = true;\r\n    this.usersEntity = conf.usersEntity;\r\n    this.eventsEntity = conf.eventsEntity;\r\n    this.resStatus = null;\r\n    this.users = [];\r\n    this.events = [];\r\n\r\n    this.init();\r\n  }\r\n\r\n  init() {\r\n    this.getData(this.usersEntity);\r\n    this.getData(this.eventsEntity);\r\n  }\r\n\r\n  async getData(entity) {\r\n    try {\r\n      const res = await getData(entity);\r\n      if (res.status !== 200) { throw new Error(`Entity ${entity} not exists`); }\r\n      const data = await res.json();\r\n      getDataFromJSON(data, this[entity]);\r\n      console.log(`${entity}: `, this[entity]);\r\n      console.log('emit ok');\r\n    } catch (err) {\r\n      // exception Decorator\r\n      console.log('emit error');\r\n      console.warn(err);\r\n    }\r\n  }\r\n\r\n  async storeData(entity, obj) {\r\n    try {\r\n      const res = await postData(entity, JSON.stringify(obj));\r\n      if (res.status !== 200) { throw new Error(`Entity ${entity} not exists`); }\r\n      const data = await res.json();\r\n      // eslint-disable-next-line no-param-reassign\r\n      obj.id = data.id;\r\n      this[entity].push(obj);\r\n      console.log(this[entity]);\r\n      console.log('emit render');\r\n    } catch (err) {\r\n      // exception Decorator\r\n      console.log('emit error');\r\n      console.warn(err);\r\n    }\r\n  }\r\n\r\n  async updateData(entity, index) {\r\n    const { id } = this[entity];\r\n    const eventJson = JSON.stringify(this[entity][index]);\r\n    try {\r\n      const res = await updateData(entity, id, eventJson);\r\n      if (res.status !== 200) { throw new Error(`${id} unreacheble or not exists`); }\r\n      console.log('emit render');\r\n    } catch (err) {\r\n      // exception Decorator\r\n      console.log('emit error');\r\n      console.warn(err);\r\n    }\r\n  }\r\n} // end class DataLayer\r\n\r\nfunction getDataFromJSON(data, list) {\r\n  data.forEach(obj => {\r\n    const item = { id: obj.id, ...JSON.parse(obj.data) };\r\n    list.push(item);\r\n  });\r\n}\r\n\r\n// const data = new DataLayer(conf.url, conf.system, conf.entities);\r\n\r\n// console.log(data);\r\n\r\n// data.getData(conf.entities[0]);\r\n","__webpack_require__.h = function() { return \"3cc5b60b9f902a97f5e0\"; }"],"sourceRoot":""}